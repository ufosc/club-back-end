# Club Back-End Design

This document should help describe the design of the system to help people get started on it.

## Database

We are using a relational database called [PostgreSQL](https://www.postgresql.org/). In a relational database, data is stored in multiple "tables", each representing a collection of information about some thing. Tables can be connected to show relationships between them, such as members being able to work on projects. The current design is described in [this image](database-schema.png).

> Note: As of right now, the tables for resources, expenses, and weekly announcements are not implemented in the database. They will be added once we have a better understanding of their usage.

### Using the Database

We are using a Rust library called [Diesel](http://diesel.rs/) to use the database. It is made up of a command line interface (used to create the migrations folder and the `schema.rs` file) and a library with a set of Rust API to connect and modify the database without needing to write a lot of SQL. The [getting started guide for Diesel](http://diesel.rs/guides/getting-started/) does a good job off explaining how to use it in a simple case.

The migrations folder contains a set of upgrades and downgrades for the database. These define how the database is structured (in this case to reflect the [database schema diagram](database-schema.png)). They are created with the Diesel CLI and SQL code.

The `schema.rs` file (located in the `src` directory) is generated by the Diesel CLI (**so don't modify it directly**). It is used by the Diesel library to connect the database structure to Rust code.

There are a set of models (for example, the `member.rs` and `attendance.rs` files) that describe the values of one item in each of the database table (so a single member inside of the members table). They also contain a set of [CRUD functions](https://en.wikipedia.org/wiki/Create,_read,_update_and_delete) to modify data from their corresponding tables.

## HTTP Requests

To allow clients (like the website or Discord bot) to communicate with the back-end, we use what's called an [HTTP Request](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods) in a [REST pattern](https://developer.mozilla.org/en-US/docs/Glossary/REST). This is a very standard way for websites and apps to send and receive data to and from servers.

These allow current clients (like the website) and any future ones to easily communicate with the server, regardless of platform. It also allows us to have authentication, so we can prevent some information from being publicly available (like a list of all the members and their emails). 

### Using HTTP Requests

We are using a Rust library called [Rocket](https://rocket.rs/) to handle the HTTP requests. This allows us to focus on the actual business rules, rather than worry about networking. They have excellent documentation on how to use it available [here](https://rocket.rs/v0.4/guide/).

## Testing

The standard Rust way of [testing](https://doc.rust-lang.org/book/ch11-00-testing.html) is to include them at the bottom of the code their testing. This makes it easy to keep them in-sync with the code they check. We encourage reading this [testing document](https://doc.rust-lang.org/book/ch11-01-writing-tests.html) and adding as many positive and negative tests as you can think of in their respective files.

## Other Resources

### Our Documentation

- The [database-schema.png](database-schema.png) and [database-schema.xml](database-schema.xml) are used to visually represent the database's structure. The image was created from the XML document using a site called [draw.io](https://www.draw.io/)
- The [extra-docker-info.md](extra-docker-info.md) describes some extra Docker commands that might help solve some problems you could encounter as well as some very useful Rust tools for automatically styling the files and testing them
- The [optimized-docker-info.md](optimized-docker-info.md) and [optimized.Dockerfile](optimized.Dockerfile) was an attempt to make a very fast and small Docker image. It currently exists as an example for how to do that, though it isn't currently used nor does it contain the database needed to work with the project.

### Examples

- [A great example of a complete web back-end and front-end using Rust](https://github.com/hgzimmerman/WeekendAtJoes4/)
	- [The author also responded to our questions about authentication](https://pastebin.com/LDpwARJq)
- [Another smaller project with a Rust backend](https://github.com/ghotiphud/rust-web-starter)